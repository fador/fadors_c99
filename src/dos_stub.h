#ifndef DOS_STUB_H
#define DOS_STUB_H

static const unsigned char dos_stub[] = {
    /* 0x00 */ 0x4D, 0x5A, 0x90, 0x00, 0x03, 0x00, 0x00, 0x00,
    /* 0x08 */ 0x04, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00,
    /* 0x10 */ 0x00, 0x00, 0xF0, 0xFF, 0x00, 0x00, 0x00, 0x00, /* SS=0, SP=0xFFF0, Csum=0, IP=0 */
    /* 0x18 */ 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, /* CS=0, lfarlc=0x40, ovno=0, res=0 */
    /* 0x20 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 0x28 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 0x30 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 0x38 */ 0x00, 0x00, 0x00, 0x00, /* Reserved */
    /* 0x3C */ 0x80, 0x00, 0x00, 0x00, /* e_lfanew = 0x80 */
    
    /* 0x40 (64) Code Starts */
    /* Segments */
    0x0E, 0x1F, 0x8C, 0xC8, 0x8E, 0xD0, 0x1E, 0x07, 
    
    /* Zero BSS Loop: offset 64+6 = 70 */
    /* mov edi, BSS_START (offset +2 = 72) */
    0x66, 0xBF, 0x00, 0x00, 0x00, 0x00, 
    /* mov ecx, BSS_SIZE  (offset +8 = 78) */
    0x66, 0xB9, 0x00, 0x00, 0x00, 0x00,
    /* xor eax, eax */
    0x66, 0x31, 0xC0,
    /* rep stosb addr32 */ 
    0x67, 0xF3, 0xAA,
    
    /* Stack Setup: offset 70+18 = 88 */
    /* XOR ESP, ESP (66 31 E4) */
    0x66, 0x31, 0xE4,
    /* MOV SP, 0xFFF0 (BC F0 FF) */
    0xBC, 0xF0, 0xFF,
    /* XOR EBP, EBP (66 31 ED) */
    0x66, 0x31, 0xED,
    
    /* Call Main */
    /* PUSH 0 (6A 00) for argc/argv placeholder */
    0x66, 0x6A, 0x00,
    
    /* CALL entry (66 E8 xx xx xx xx) - 32-bit call */
    /* Offset 88+11 = 99. OpCode 66 E8. Operand at 101. */
    0x66, 0xE8, 0x00, 0x00, 0x00, 0x00,
    
    /* EXIT (B4 4C CD 21) */
    0xB4, 0x4C, 0xCD, 0x21
};
#endif
